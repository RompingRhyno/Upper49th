@using Customer.Membership.Models

@model MembershipModel
@{
    Layout = "_Layout";
}

<h2>Sign Up for a Membership</h2>

<form method="post" asp-action="SignUp">
    @Html.AntiForgeryToken()

    @if (Model.CurrentStep == 1)
    {
        @await Html.PartialAsync("~/Views/Membership/Partials/_PlanSelection.cshtml", Model)
    }
    else if (Model.CurrentStep == 2)
    {
        @await Html.PartialAsync("~/Views/Membership/Partials/_PaymentMethod.cshtml", Model)
    }

    <button type="submit" class="btn btn-primary mt-3"> @(Model.CurrentStep == 1 ? "Continue to Billing" : "Complete Sign Up")</button>

    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
</form>


@section Styles {
    <link rel="stylesheet" href="~/plugins/Customer.Membership/css/membership.css" />
}

@section Scripts {
    <script>
        let selectedPlan = "";

        document.querySelectorAll(".membership-btn").forEach(btn => {
            btn.addEventListener("click", function () {
                selectedPlan = this.dataset.plan;
                document.getElementById("SelectedPlan").value = selectedPlan;

                document.querySelectorAll(".membership-btn").forEach(b => b.classList.remove("selected"));
                this.classList.add("selected");

                console.log("Selected plan:", selectedPlan);
            });
        });
    </script>
}